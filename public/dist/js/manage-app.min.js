/*!
 Docsyard by LivelyWorks - http://livelyworks.net
 version: 1.x
 --------------------------------------------------------------------- 
 Build Timestamp: 1632901508
 Build Date: Wed Sep 29 2021 13:15:08 GMT+0530 (India Standard Time)
--------------------------------------------------------------------- */
!function(){"use strict";angular.module("ManageApp",["ngMessages","ngAnimate","ngSanitize","ui.router","ui.tree","ngNotify","ngDialog","angular-loading-bar","selectize","NgSwitchery","lw.core.utils","lw.security.main","lw.auth","lw.data.datastore","lw.data.datatable","lw.form.main","app.service","app.http","app.notification","app.form","app.directives","app.fileUploader","ManageApp.master","app.UploaderDataService","app.UploaderEngine","ManageApp.ManageUserDataService","ManageApp.users","CommonApp.CommonUserDataService","CommonApp.users","Manage-app.users","ManageApp.UserDataService","ManageApp.ConfigurationDataService","ManageApp.configuration","app.RolePermissionDataServices","app.RolePermissionEngine","app.ActivityDataServices","app.ActivityEngine","app.ProjectDataServices","app.ProjectEngine","app.ArticleDataServices","app.ArticleEngine","app.LanguageDataServices","app.LanguageEngine","app.VersionDataServices","app.VersionEngine"]).run(["__Auth","$state","$rootScope","$transitions","$trace",function(e,t,a,o,r){_.delay(function(){e.verifyRoute(t)},100),a.__ngSupport=window.__ngSupport}]).config(["$stateProvider","$urlRouterProvider","$interpolateProvider","$compileProvider",function(e,t,a,o){window.appConfig&&!1===window.appConfig.debug&&o.debugInfoEnabled(!1);a.startSymbol("[["),a.endSymbol("]]"),t.otherwise(function(e,t,a){var o=e.get("$state"),e=(e.get("__Auth"),__globals.appTemps("stateViaRoute"));return!_.has(e,"stateName")||_.isUndefined(e.stateName)||_.isEmpty(e.stateName)?o.go("project"):_.isEmpty(e.stateParams)?o.go(e.stateName):o.go(e.stateName,e.stateParams),t.path()}),e.state("base",{abstract:!0,resolve:{baseData:["$stateParams","BaseDataService",function(e,t){return t.getBaseData("account_logged")}]}}).state("login",__globals.stateConfig("/login","user.login",{parent:"base",access:{authority:"user.login.process"}})).state("forgot_password",__globals.stateConfig("/forgot-password","user.forgot-password",{parent:"base",access:{authority:"user.forgot_password.process"}})).state("reset_password",__globals.stateConfig("/reset-password/{reminderToken}","user.reset-password",{parent:"base",access:{authority:"user.reset_password.process"}})).state("forgot_password_sucess",__globals.stateConfig("/forgot-password","user.forgot-password-success")).state("home",__globals.stateConfig("/home","home",{access:{authority:"public.app"},parent:"base"})).state("invalid_request",__globals.stateConfig("/invalid-request","errors/invalid-request")).state("not_found",__globals.stateConfig("/not-found","errors.manage-not-exist")).state("not_exist",__globals.stateConfig("/not-exist","errors.manage-not-exist")).state("unauthorized",__globals.stateConfig("/unauthorized","errors.unauthorized")).state("users",__globals.stateConfig("/users","user/manage/list",{controller:"ManageUsersController as manageUsersCtrl",access:{authority:"manage.user.read.datatable.list"},parent:"base"})).state("role_permission",__globals.stateConfig("/role-permissions","user/role-permission/list",{access:{authority:"manage.user.role_permission.read.list"},controller:"RolePermissionListController as rolePermissionListCtrl",parent:"base"})).state("profile",__globals.stateConfig("/profile","user/manage-profile",{access:{authority:"user.profile.update"},parent:"base"})).state("profileEdit",__globals.stateConfig("/profile/edit","user/profile-edit",{access:{authority:"user.profile.update.process"},parent:"base"})).state("changePassword",__globals.stateConfig("/change-password","user/change-password",{access:{authority:"user.change_password.process"},parent:"base"})).state("changeEmail",__globals.stateConfig("/change-email","user/change-email",{access:{authority:"user.change_email.process"},parent:"base"})).state("activity_log",__globals.stateConfig("/activity-log","activity/activity-log",{controller:"ActivityLogListController as activityLogListCtrl",parent:"base",access:{authority:"manage.activity_log.read.list"}})).state("configuration_general",__globals.stateConfig("/general","configuration.general",{parent:"base",parent:"base",controller:"GeneralController as generalCtrl",access:{authority:"manage.configuration.process"},resolve:{getGeneralData:["ConfigurationDataService",function(e){return e.readConfigurationData(1).then(function(e){return e})}]}})).state("project",__globals.stateConfig("/projects","project/list",{access:{authority:"manage.project.read.list"},controller:"ProjectListController as projectListCtrl",parent:"base"})).state("project_articles",__globals.stateConfig("/project/:projectUid/:versionUid/articles","article/list",{access:{authority:"manage.article.read.list"},controller:"ArticleListController as articleListCtrl",parent:"base",resolve:{GetVersionDetails:["VersionDataService","$stateParams",function(e,t){return e.getVersionSupportData(t.projectUid,t.versionUid)}],GetArticles:["ArticleDataService","$stateParams",function(e,t){return e.getArticles(t.projectUid,t.versionUid)}]}})).state("project_article_add",__globals.stateConfig("/project/:projectUid/:versionUid/article/:requestType/add","article/add",{access:{authority:"manage.article.write.create"},controller:"ArticleAddController as ArticleAddCtrl",parent:"base",resolve:{articleAddData:["ArticleDataService","$stateParams",function(e,t){return e.getAddSupportData(t.projectUid,t.versionUid)}],GetVersionDetails:["VersionDataService","$stateParams",function(e,t){return e.getVersionSupportData(t.projectUid,t.versionUid)}]}})).state("project_subarticle_add",__globals.stateConfig("/project/:projectUid/:versionUid/:prevArticle/article/:requestType/add","article/add",{access:{authority:"manage.article.write.create"},controller:"ArticleAddController as ArticleAddCtrl",parent:"base",parent:"base",resolve:{articleAddData:["ArticleDataService","$stateParams",function(e,t){return e.getAddSupportData(t.projectUid,t.versionUid)}]}})).state("project_article_edit",__globals.stateConfig("/project/:projectUid/:versionUid/article/:articleIdOrUid/edit","article/edit",{access:{authority:"manage.article.read.update.data"},controller:"ArticleEditController as articleEditCtrl",parent:"base",parent:"base",resolve:{articleEditData:["ArticleDataService","$stateParams",function(e,t){return e.getEditSupportData(t.articleIdOrUid,t.projectUid,t.versionUid)}]}})).state("article",__globals.stateConfig("/articles","article/list",{access:{authority:"manage.article.read.list"},controller:"ArticleListController as articleListCtrl",parent:"base"})).state("article_add",__globals.stateConfig("/article-add","article/add",{access:{authority:"manage.article.write.create"},controller:"ArticleAddController as ArticleAddCtrl",parent:"base",resolve:{articleAddData:["ArticleDataService",function(e){return e.getAddSupportData()}]}})).state("article_edit",__globals.stateConfig("/:articleIdOrUid/edit","article/edit",{access:{authority:"manage.article.write.update"},controller:"ArticleEditController as articleEditCtrl",parent:"base",resolve:{articleEditData:["ArticleDataService","$stateParams",function(e,t){return e.getEditSupportData(t.articleIdOrUid)}]}})).state("article_details",__globals.stateConfig("/article/:articleIdOrUid/:requestType/details","article/details",{access:{authority:"manage.article.read.details"},controller:"ArticleDetailsController as ArticleDetailsCtrl",parent:"base",resolve:{ArticleData:["ArticleDataService","$stateParams",function(e,t){return e.getArticleDetails(t.articleIdOrUid)}]}})).state("language",__globals.stateConfig("/languages","language/list",{access:{authority:"manage.language.read.list"},controller:"LanguageListController as languageListCtrl",parent:"base"})).state("project_versions",__globals.stateConfig("/project/{projectIdOrUid}/versions","version/list",{access:{authority:"manage.project.version.read.list"},parent:"base",controller:"VersionListController as versionListCtrl",resolve:{ProjectInfo:["VersionDataService","$stateParams",function(e,t){return e.getProjectInfo(t.projectIdOrUid)}],GetVersions:["VersionDataService","$stateParams",function(e,t){return e.getVersions(t.projectIdOrUid)}]}})).state("version.add",__globals.stateConfig("/project-add",null,{access:{authority:"manage.project.version.write.create"},controller:"VersionAddDialogController",resolve:{versionAddData:function(e){return e.getAddSupportData()}}})).state("version.edit",__globals.stateConfig("/:projectIdOrUid/edit",null,{access:{authority:"manage.project.version.write.update"},controller:"VersionEditDialogController as versionEditDialogCtrl",resolve:{versionEditData:function(e,t){return e.getEditSupportData(t.projectIdOrUid)}}}))}])}(),function(){"use strict";angular.module("ManageApp.master",[]).controller("ManageController",["$rootScope","__DataStore","$scope","__Auth","appServices","appNotify","__Form","$state","appToastNotify","ConfigurationDataService",function(a,t,e,o,r,s,i,n,c,l){var d=this;d.dropdown_menu=__globals.getAppImmutables("dropdown_menu"),d.pageStatus=!1,d.refreshAuthObj=function(){o.refresh(function(e){d.auth_info=e})},d.refreshAuthObj(),d.notify=__globals.getAppImmutables("notifyToAdmin"),d.restrict_user_email_update=__globals.getAppImmutables("restrict_user_email_update"),d.unhandledError=function(){s.error(__globals.getReactionMessage(19))},a.isAdmin=function(){return 1===d.auth_info.designation},a.$on("auth_info_updated",function(e,t){a.auth_info=t.auth_info,_.isEmpty(t.userFullName)||(d.userUpdateData=t.userFullName),d.auth_info=a.auth_info}),a.$on("lw.events.logged_in_user",function(){d.refreshAuthObj()}),a.$on("lw.events.state.change_start",function(){r.closeAllDialog()}),a.$on("lw.datastore.event.post.started",__globals.showButtonLoader),a.$on("lw.datastore.event.fetch.started",__globals.showFormLoader),a.$on("lw.form.event.process.started"),a.$on("lw.form.event.fetch.started",__globals.showFormLoader),a.$on("lw.datastore.event.fetch.finished",__globals.hideFormLoader),a.$on("lw.datastore.event.post.finished",__globals.hideButtonLoader),a.$on("lw.form.event.process.finished",__globals.hideButtonLoader),a.$on("lw.datastore.event.fetch.error",d.unhandledError),a.$on("lw.form.event.process.error",d.unhandledError),a.$on("$stateChangeSuccess",function(e,t){var a=__globals.getScrollOffsets(),a=Math.round(a.y);$("html, body").animate({scrollTop:0},a<500?500:a)}),a.$on("ngDialog.opened",function(e,t){_.defer(function(){$(".ngdialog").scrollTop(0)})}),d.isLoggedIn=function(){return o.isLoggedIn()},d.logoutUser=function(){o.registerIntended("dashboard"),t.post("user.logout").success(function(e){1==e.reaction&&o.checkOut({},function(e){n.go("login")})})},d.showGeneralSetting=function(){l.readConfigurationData(1).then(function(e){var t=e.data.configuration.logo_background_color;r.showDialog({responseData:e},{templateUrl:__globals.getTemplateURL("configuration.general")},function(e){$("#lwchangeBgHeaderColor").css("background","#"+t)})})},d.themeColors=__globals.getAppImmutables("config").theme_colors,d.setThemeColor=function(e){t.fetch({apiURL:"theme_color",colorName:e}).success(function(e){location.reload()})},d.showHideThemeContainer=function(){$(".lw-theme-color-container").hasClass("lw-theme-container-active")?($(".lw-theme-color-container").removeClass("lw-theme-container-active"),$(".lw-switch span:first").replaceWith("<i class='fa fa-cog'></i>")):($(".lw-theme-color-container").addClass("lw-theme-container-active"),$(".lw-switch i:first").replaceWith("<span>&times;</span>"))}}])}(),function(){"use strict";window.angular.module("ManageApp.ManageUserDataService",[]).service("ManageUserDataService",["$q","__DataStore","__Form","appServices",function(t,o,e,r){this.getUserInfo=function(e){var a=t.defer();return o.fetch({apiURL:"manage.user.read.info",userId:e}).success(function(t){r.processResponse(t,null,function(e){a.resolve(t)})}),a.promise},this.getUserAddSupportData=function(){var a=t.defer();return o.fetch("manage.user.read.create.support_data").success(function(t){r.processResponse(t,null,function(e){a.resolve(t)})}),a.promise},this.getUserPermissions=function(e){var a=t.defer();return o.fetch({apiURL:"manage.user.read.get_user_permissions",userId:e}).success(function(t){r.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise},this.getUserDetailData=function(e){var a=t.defer();return o.fetch({apiURL:"manage.user.read.detail.data",userID:e}).success(function(t){r.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise},this.getUserEditData=function(e){var a=t.defer();return o.fetch({apiURL:"manage.user.read.edit_suppport_data",userId:e}).success(function(t){r.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise}}])}(window),function(){"use strict";window.angular.module("ManageApp.users",[]).controller("ManageUsersController",["$scope","__DataStore","appServices","ManageUserDataService","ConfigurationDataService",function(a,o,r,s,e){var i=[{name:null,template:"#profileImageColumnTemplate"},{name:"name",template:"#userNameColumnTemplate",orderable:!0},{name:"username",orderable:!0},{name:"email",orderable:!0},{name:"updated_at",template:"#userUpdatedDateColumnTemplate",orderable:!0},{name:"user_role",orderable:!0},{name:null,template:"#userActionColumnTemplate"}],n=[{name:null,template:"#profileImageColumnTemplate"},{name:"name",template:"#userNameColumnTemplate",orderable:!0},{name:"username",orderable:!0},{name:"email",orderable:!0},{name:"updated_at",template:"#userUpdatedDateColumnTemplate",orderable:!0},{name:"user_role",orderable:!0},{name:null,template:"#userActionColumnTemplate"}],t={active:{id:"activeUsersTabList",status:1},inactive:{id:"inactiveUsersTabList",status:2},deleted:{id:"deletedUsersTabList",status:5}},c=1,l=this;$("#manageUsersTabs a").click(function(e){e.preventDefault();e=$(this).attr("aria-controls"),e=t[e];_.isEmpty(e)||($(this).tab("show"),c=e.status,l.getUsers(e.id,e.status))}),l.getUsers=function(e,t){l.usersListDataTable&&l.usersListDataTable.destroy(),l.usersListDataTable=o.dataTable("#"+e,{url:{apiURL:"manage.user.read.datatable.list",status:t},dtOptions:{searching:!0,pageLength:25,order:[[1,"asc"]]},columnsData:5==t?n:i,scope:a})},l.getUsers("activeUsersTabList",1),l.reloadDT=function(){o.reloadDT(l.usersListDataTable)},l.delete=function(e,t,a){l.deletingUserName=unescape(t),_.defer(function(){var e=$("#lwUserDeleteConfirmTextMsg"),t=$("#lwUserPerDeleteConfirmTextMsg");1==a?(l.deleteText=e.attr("data-message"),l.deleteConfirmBtnText=e.attr("data-delete-button-text"),l.successMsgText=e.attr("success-msg")):(l.deleteText=t.attr("data-message"),l.deleteConfirmBtnText=t.attr("data-delete-button-text"),l.successMsgText=t.attr("success-msg"))}),_.defer(function(){__globals.showConfirmation({html:l.deleteText,confirmButtonText:l.deleteConfirmBtnText},function(){o.post({apiURL:"manage.user.write.delete",userID:e}).success(function(e){var t=e.data.message;r.processResponse(e,{error:function(){__globals.showConfirmation({title:"Deleted!",text:t,type:"error"})}},function(){__globals.showConfirmation({title:"Deleted!",text:l.successMsgText,type:"success"}),l.reloadDT()})})})})},l.restore=function(t,e){l.restoringUserName=unescape(e),_.defer(function(){var e=$("#lwUserRestoreConfirmTextMsg");__globals.showConfirmation({text:e.attr("data-message"),confirmButtonText:e.attr("data-restore-button-text")},function(){o.post({apiURL:"manage.user.write.restore",userID:t}).success(function(e){var t=e.data.message;r.processResponse(e,{error:function(){__globals.showConfirmation({title:"Restore!",text:t,type:"error"})}},function(){__globals.showConfirmation({title:"Restore!",text:t,type:"success"}),l.reloadDT()})})})})},l.changePassword=function(e,t){r.showDialog({userID:e,name:unescape(t)},{templateUrl:__globals.getTemplateURL("user.manage.change-password"),controller:"ManageUserChangePasswordController as userChangePassword"},function(e){})},l.showAddNewDialog=function(){r.showDialog({showRoleSelectBox:!0},{templateUrl:__globals.getTemplateURL("user.manage.add-dialog")},function(e){_.has(e.value,"user_added")&&1==e.value.user_added&&1==c&&l.reloadDT()})},l.editUserDialog=function(e,t){r.showDialog({userId:e,name:t},{templateUrl:"user.manage.edit-dialog",controller:"EditUserDialogController as EditUserDialogCtrl",resolve:{EditUserData:function(){return s.getUserEditData(e)}}},function(e){_.has(e.value,"user_updated")&&1==e.value.user_updated&&l.reloadDT()})},l.showUsersConfigurationDialog=function(){e.readConfigurationData(5).then(function(e){r.showDialog({responseData:e},{templateUrl:__globals.getTemplateURL("configuration.users")},function(e){})})},l.usersPermissionDialog=function(e,t){r.showDialog({userId:e,fullName:_.unescape(t)},{templateUrl:__globals.getTemplateURL("user.manage.user-dynamic-permission"),controller:"ManageUsersDynamicPermissionController as manageUsersDynamicPermissionCtrl",resolve:{UserPermission:function(){return s.getUserPermissions(e)}}},function(e){})},l.openUserDetailsDialog=function(e){r.showDialog({},{templateUrl:__globals.getTemplateURL("user.manage.user-detail-dialog"),controller:"ManageUsersDetailController as manageUsersDetailCtrl",resolve:{UserDetailData:function(){return s.getUserDetailData(e)}}},function(e){})},l.showAssignLocationDialog=function(e,t){r.showDialog({userAuthorityId:e,name:unescape(t)},{templateUrl:__globals.getTemplateURL("location.assign-location-dialog"),controller:"AssignLocationController as AssignLocationCtrl",resolve:{assignLocationData:function(){return LocationDataService.getAssignLocationData(e)}}},function(e){})}}]).controller("AddUserDialogController",["$scope","__Form","appServices","ManageUserDataService",function(t,e,a,o){var r=this;(r=e.setup(r,"add_user_form","userData",{secured:!0,unsecuredFields:["first_name","last_name"]})).showRoleSelectBox=t.ngDialogData.showRoleSelectBox,o.getUserAddSupportData().then(function(e){e=e.data;r.userRoles=e.userRoles}),r.submit=function(){e.process("manage.user.write.create",r).success(function(e){a.processResponse(e,null,function(){t.closeThisDialog({user_added:!0,user_data:e.data.userData})})})},r.closeDialog=function(){t.closeThisDialog()}}]).controller("ManageUserChangePasswordController",["$scope","__Form","appServices",function(t,e,a){var o=this;(o=e.setup(o,"change_password_form","changePasswordData",{secured:!0})).ngDialogData=t.ngDialogData,o.title=unescape(o.ngDialogData.name),o.userID=o.ngDialogData.userID,o.submit=function(){e.process({apiURL:"manage.user.write.change_password.process",userID:o.userID},o).success(function(e){a.processResponse(e,null,function(){t.closeThisDialog()})})},o.closeDialog=function(){t.closeThisDialog()}}]).controller("ManageUsersDetailController",["$scope","__DataStore","__Form","$stateParams","appServices","UserDetailData",function(e,t,a,o,r,s){this.userData=s.userData,this.closeDialog=function(){e.closeThisDialog()}}]).controller("ManageUsersDynamicPermissionController",["$scope","__Form","__DataStore","appServices","UserPermission",function(t,e,a,o,r){var s=this;(s=e.setup(s,"user_dynamic_access","accessData",{secured:!0,unsecuredFields:[]})).ngDialogData=t.ngDialogData,s.userId=s.ngDialogData.userId,s.fullName=s.ngDialogData.fullName,s.requestData=r,s.permissions=s.requestData.permissions,s.accessData.allow_permissions=s.requestData.allow_permissions,s.accessData.deny_permissions=s.requestData.deny_permissions,s.accessData.inherit_permissions=s.requestData.inherit_permissions,s.disablePermissions=function(e,a){_.map(e.children,function(t){_.includes(t.dependencies,a)&&_.delay(function(e){$('input[name="'+t.id+'"]').attr("disabled",!0)},500)})},s.checkedPermission={},_.map(s.accessData.allow_permissions,function(e){s.checkedPermission[e]="2"}),_.map(s.accessData.deny_permissions,function(a){s.checkedPermission[a]="3",_.map(s.permissions,function(e){var t=_.get(e.children,"id");_.includes(t,a)&&s.disablePermissions(e,a),_.has(e,"children_permission_group")&&_.map(e.children_permission_group,function(e){var t=_.get(e.children,"id");_.includes(t,a)&&s.disablePermissions(e,a)})})}),_.map(s.accessData.inherit_permissions,function(a){s.checkedPermission[a]="1",_.map(s.permissions,function(e){var t=_.map(e.children,"id");_.includes(t,a)&&0==e.children[0].inheritStatus&&"1"==e.children[0].result&&s.disablePermissions(e,a),_.has(e,"children_permission_group")&&_.map(e.children_permission_group,function(e){var t=_.map(e.children,"id");_.includes(t,a)&&0==e.children[0].inheritStatus&&"1"==e.children[0].result&&s.disablePermissions(e,a)})})}),s.checkPermission=function(a,o){_.isString(o)||(o=o.toString()),"2"==(s.checkedPermission[a]=o)?(_.includes(s.accessData.allow_permissions,a)||s.accessData.allow_permissions.push(a),_.includes(s.accessData.deny_permissions,a)&&(s.accessData.deny_permissions=_.without(s.accessData.deny_permissions,a))):("3"==o?_.includes(s.accessData.deny_permissions,a)||s.accessData.deny_permissions.push(a):_.includes(s.accessData.deny_permissions,a)&&(s.accessData.deny_permissions=_.without(s.accessData.deny_permissions,a)),_.includes(s.accessData.allow_permissions,a)&&(s.accessData.allow_permissions=_.without(s.accessData.allow_permissions,a))),_.map(s.permissions,function(t){var e=_.map(t.children,"id");_.includes(e,a)&&t.children[0].id==a&&_.map(t.children,function(e){_.includes(e.dependencies,a)&&"3"==o||_.includes(e.dependencies,a)&&"1"==o&&t.children[0].result&&0==t.children[0].inheritStatus?$('input[name="'+e.id+'"]').attr("disabled",!0):$('input[name="'+e.id+'"]').attr("disabled",!1)}),_.has(t,"children_permission_group")&&_.map(t.children_permission_group,function(t){var e=_.map(t.children,"id");_.includes(e,a)&&t.children[0].id==a&&_.map(t.children,function(e){_.includes(e.dependencies,a)&&"3"==o||_.includes(e.dependencies,a)&&"1"==o&&t.children[0].result&&0==t.children[0].inheritStatus?$('input[name="'+e.id+'"]').attr("disabled",!0):$('input[name="'+e.id+'"]').attr("disabled",!1)})})})},s.submit=function(){e.process({apiURL:"manage.user.write.user_dynamic_permission",userId:s.userId},s).success(function(e){o.processResponse(e,null,function(){t.closeThisDialog()})})},s.closeDialog=function(){t.closeThisDialog()}}]).controller("EditUserDialogController",["$scope","__DataStore","__Form","$stateParams","appServices","EditUserData",function(t,e,a,o,r,s){var i=this,s=s,n=t.ngDialogData;i.userRoles=s.userRoles,i=a.setup(i,"user_edit_form","userData"),(i=a.updateModel(i,s.userUpdateData)).submit=function(){a.process({apiURL:"manage.user.write.update_process",userId:n.userId},i).success(function(e){r.processResponse(e,null,function(){t.closeThisDialog({user_updated:!0})})})},i.closeDialog=function(){t.closeThisDialog()}}])}(window),function(){"use strict";window.angular.module("ManageApp.UserDataService",[]).service("UserDataService",["$q","__DataStore","__Form","appServices",function(e,t,o,r){this.getLoginAttempts=function(){var a=e.defer();return o.fetch("user.login.attempts").success(function(t){r.processResponse(t,null,function(e){a.resolve(t)})}),a.promise},this.getCountries=function(){var a=e.defer();return t.fetch("user.get.country_list").success(function(t){r.processResponse(t,null,function(e){a.resolve(t)})}),a.promise}}])}(window),function(){"use strict";window.angular.module("Manage-app.users",[]).controller("UserLoginController",["__Form","__Auth","appServices","__Utils","UserDataService","$state","$rootScope",function(e,a,o,t,r,s,i){var n=this;(n=e.setup(n,"form_user_login","loginData",{secured:!0})).show_captcha=!1,n.request_completed=!1,r.getLoginAttempts().then(function(e){n.show_captcha=e.data.show_captcha,n.site_key=e.data.site_key,n.request_completed=!0}),n.redirectToIntended=function(){return __globals.intended&&__globals.intended.name&&__globals.intended.params?s.go(__globals.intended.name,__globals.intended.params):__globals.intended&&__globals.intended.name?s.go(__globals.intended.name):s.go("project")},n.getCaptchaURL=function(){return t.apiURL("security.captcha")+"?ver="+Math.random()},n.refreshCaptcha=function(){n.captchaURL=n.getCaptchaURL()},n.captchaURL=n.getCaptchaURL(),n.submit=function(){n.isInActive=!1,n.accountDeleted=!1,e.process("user.login.process",n).success(function(e){var t=e.data;o.processResponse(e,{error:function(){n.show_captcha=t.show_captcha,n[n.ngFormModelName].password="",n.show_captcha&&(n[n.ngFormModelName].confirmation_code="",n.refreshCaptcha())},otherError:function(e){n.isInActive=t.isInActive,n.accountDeleted=t.accountDeleted,3==e&&n.show_captcha&&n.refreshCaptcha(),10==e&&n.redirectToIntended()}},function(){a.checkIn(t.auth_info,function(){t.availableRoutes&&__globals.appImmutable("availableRoutes",t.availableRoutes),t.ckeditor&&__globals.appImmutable("ckeditor",t.ckeditor),t.intendedUrl?__globals.redirectBrowser(t.intendedUrl):(i.$emit("lw.events.logged_in_user",{data:!0}),n.redirectToIntended())})})})}}]).controller("UserLogoutController",["__DataStore","__Auth","appServices",function(e,a,o){e.post("user.logout").success(function(t){o.processResponse(t,function(e){a.checkIn(t.data.auth_info)})})}]).controller("UserForgotPasswordController",["__Form","appServices","__Utils","$state",function(e,t,a,o){var r=this;(r=e.setup(r,"user_forgot_password_form","userData",{secured:!0})).submit=function(){e.process("user.forgot_password.process",r).success(function(e){t.processResponse(e,null,function(){o.go("forgot_password_sucess")})})}}]).controller("UserResetPasswordController",["__Form","appServices","__Utils","$state",function(e,t,a,o){var r=this;(r=e.setup(r,"user_reset_password_form","userData",{secured:!0})).submit=function(){e.process({apiURL:"user.reset_password.process",reminderToken:o.params.reminderToken},r).success(function(e){t.processResponse(e,null,function(e){o.go("login")})})}}])}(window),function(){"use strict";window.angular.module("ManageApp.ConfigurationDataService",[]).service("ConfigurationDataService",["$q","__DataStore","appServices",function(t,o,r){this.readConfigurationData=function(e){var a=t.defer();return o.fetch({apiURL:"manage.configuration.get.support.data",formType:e}).success(function(t){r.processResponse(t,null,function(e){a.resolve(t)})}),a.promise}}])}(window),function(){"use strict";window.angular.module("ManageApp.configuration",[]).controller("GeneralController",["$scope","__Form","$state","appServices","lwFileUploader","__Utils","$rootScope","getGeneralData",function(a,e,t,o,r,s,i,n){var c=this;c.default_header_background_color=n.data.configuration.default_header_background_color,c.default_header_text_link_color=n.data.configuration.default_header_text_link_color,c.themeColors=n.data.configuration.theme_colors,(c=e.setup(c,"general_edit","editData",{secured:!0,modelUpdateWatcher:!0,unsecuredFields:["logoURL","faviconURL","name"]})).pageStatus=!1,c.timezone_select_config=__globals.getSelectizeOptions({valueField:"value",labelField:"text",searchField:["text"]}),c.home_page_select_config=__globals.getSelectizeOptions({valueField:"id"}),c.selectSiteColor=function(e){c.editData.header_background_color=e.background,c.editData.header_text_link_color=e.text},c.checkLogo=function(e){var t=!1;(t=c.editData.invoice_logo_image==c.editData.logo_image?!0:t)&&(1==e?c.editData.invoice_logo_image="":2==e&&(c.editData.logo_image=""))},c.clearColor=function(){c.editData.header_background_color=c.default_header_background_color},c.clearPrimaryColor=function(){c.editData.header_text_link_color=c.default_header_text_link_color};var l=n.data;c.timezoneData=l.configuration.timezone_list,c.homePageData=__globals.generateKeyValueItems(l.configuration.home_page_list),c.languages=l.configuration.locale_list;l=l.configuration;e.updateModel(c,l),c.pageStatus=!0,c.imagesSelectConfig=__globals.getSelectizeOptions({valueField:"name",labelField:"name",render:{item:function(e,t){return s.template("#imageListItemTemplate",e)},option:function(e,t){return s.template("#imageListOptionTemplate",e)}},searchField:["name"]}),c.retrieveSpecificFiles=function(){r.getTempUploadedFiles(c,{url:s.apiURL("media.upload.read_logo")},function(e){c.logoFiles=e,c.logoFilesCount=e.length})},c.retrieveSpecificFiles(),c.retrieveFaviconFiles=function(){r.getTempUploadedFiles(c,{url:s.apiURL("media.upload.read_favicon")},function(e){c.faviconFiles=e,c.faviconFilesCount=e.length})},c.retrieveFaviconFiles(),i.$on("lw-loader-event-start",function(e,t){a.loading=!0,$("#lwFileupload").attr("disabled",!0)}),i.$on("lw-loader-event-stop",function(e,t){a.loading=!1,$("#lwFileupload").attr("disabled",!1)}),a.upload=function(){r.upload({url:s.apiURL("media.upload.write.logo")},function(e){c.retrieveSpecificFiles(),c.retrieveFaviconFiles()})},a.showUploadedMediaDialog=function(){r.openDialog(c,{url:s.apiURL("media.upload.read_logo")},function(e){c.retrieveSpecificFiles(),c.retrieveFaviconFiles()})},c.submit=function(){e.process({apiURL:"manage.configuration.process",formType:1},c).success(function(e){o.processResponse(e,null,function(){1==e.data.showRealodButton&&__globals.showConfirmation({title:e.data.message,text:e.data.textMessage,type:"success",confirmButtonClass:"btn-success",confirmButtonText:$("#lwReloadBtnText").attr("data-message"),confirmButtonColor:"#337ab7"},function(){location.reload()})})})};n.data.configuration.logo_background_color;c.closeDialog=function(){a.closeThisDialog()}}]).controller("CurrencyConfigurationController",["$scope","__Form","appServices","getCurrencyData",function(e,t,a,o){var r=this;e.ngDialogData;r.isZeroDecimalCurrency=!1,r.generateCurrenciesArray=function(e,t){if(!t)return e;var a=[];_.forEach(e,function(e,t){a.push({currency_code:t,currency_name:e.name})});e=$("#lwCurrencySettingTxtMsg");return a.push({currency_code:"other",currency_name:e.attr("other-text")}),a},r.checkIsZeroDecimalCurrency=function(e,a){e=_.filter(e,function(e,t){return t===a});r.isZeroDecimalCurrency=Boolean(e.length)},r.checkIsPaypalSupported=function(a){var e=_.filter(r.options,function(e,t){return t==a});r.isPaypalSupport=Boolean(e.length)},r.formatCurrency=function(t,a){_.defer(function(){var e=$("#lwCurrencyFormat").attr("data-format");r.currency_format_preview=e.split("{__currencySymbol__}").join(t).split("{__amount__}").join(100).split("{__currencyCode__}").join(a)})},r.pageStatus=!1,(r=t.setup(r,"edit_currency_configuration","editData",{secured:!0,unsecuredFields:["currency_symbol","currency_format"]})).currencies_select_config=__globals.getSelectizeOptions({valueField:"currency_code",labelField:"currency_name",searchField:["currency_code","currency_name"]}),r.multi_currencies_select_config=__globals.getSelectizeOptions({valueField:"currency_code",labelField:"currency_name",searchField:["currency_code","currency_name"],plugins:["remove_button"],maxItems:1e3,delimiter:",",persist:!1}),r.is_support_paypal=!0;var o=o.data,s=o.configuration.currencies;r.options=s.options,r.currencies=s.details,r.zeroDecimal=s.zero_decimal,_.defer(function(){r.currencies_options=r.generateCurrenciesArray(s.details,!0)}),r.checkIsZeroDecimalCurrency(r.zeroDecimal,o.configuration.currency_value),r.checkIsPaypalSupported(o.configuration.currency),r.default_currency_format=o.configuration.default_currency_format,r.placeholders=o.placeholders,r=t.updateModel(r,o.configuration),_.forEach(r.currencies,function(e,t){t==r.editData.currency_value&&(r.currencySymbol=e.symbol)}),"other"==o.configuration.currency&&(r.currencySymbol=o.configuration.currency_symbol),r.formatCurrency(r.currencySymbol,r.editData.currency_value),r.pageStatus=!0,r.useDefaultFormat=function(e,t,a){r.editData.currency_format=e;e=r.editData.currency_format;r.currency_format_preview=e.split("{__currencySymbol__}").join(t).split("{__amount__}").join(100).split("{__currencyCode__}").join(a)},r.updateCurrencyPreview=function(e,t){_.isUndefined(e)&&(e=""),_.isUndefined(t)&&(t="");var a=$("#lwCurrencyFormat").attr("data-format");r.currency_format_preview=a.split("{__currencySymbol__}").join(e).split("{__amount__}").join(100).split("{__currencyCode__}").join(t)},r.submit=function(){t.process({apiURL:"manage.configuration.process",formType:2},r).success(function(e){a.processResponse(e,null,function(){1==e.data.showRealodButton&&__globals.showConfirmation({title:e.data.message,text:e.data.textMessage,type:"success",showCancelButton:!0,confirmButtonClass:"btn-success",confirmButtonText:$("#lwReloadBtnText").attr("data-message"),confirmButtonColor:"#337ab7"},function(){location.reload()})})})},r.currencyChange=function(a){r.checkIsZeroDecimalCurrency(r.zeroDecimal,a),_.isEmpty(a)||"other"==a?(r.editData.currency_value="",r.editData.currency_symbol=""):(_.forEach(r.currencies,function(e,t){t==a&&(r.editData.currency_value=a,r.editData.currency_symbol=e.ASCII,r.currencySymbol=e.symbol)}),r.is_support_paypal=!0),r.updateCurrencyPreview(r.currencySymbol,r.editData.currency_value),r.checkIsPaypalSupported(r.editData.currency_value)},r.currencyValueChange=function(a){var o;r.checkIsZeroDecimalCurrency(r.zeroDecimal,a),_.isEmpty(a)||"other"==a?_.isEmpty(a)?r.editData.currency="":r.editData.currency="other":(o={},_.forEach(r.currencies,function(e,t){t==a&&(o=e)}),_.isEmpty(o)?r.editData.currency="other":(r.editData.currency=a,r.editData.currency_symbol=o.ASCII,r.currencySymbol=o.symbol)),r.checkIsPaypalSupported(a),_.isUndefined(r.editData.currency_value)&&(r.currencySymbol=""),r.updateCurrencyPreview(r.currencySymbol,r.editData.currency_value)},r.closeDialog=function(){e.closeThisDialog(r.currencySymbol,r.editData.currency)}}])}(window),function(){"use strict";window.angular.module("app.RolePermissionDataServices",[]).service("RolePermissionDataService",["$q","__DataStore","appServices",function(t,o,r){this.getPermissions=function(e){var a=t.defer();return o.fetch({apiURL:"manage.user.role_permission.read",roleId:e}).success(function(t){r.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise},this.getAddSupportData=function(){var a=t.defer();return o.fetch("manage.user.role_permission.read.add_support_data").success(function(t){r.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise},this.getAllPermissionsById=function(e){var a=t.defer();return o.fetch({apiURL:"manage.user.role_permission.read.using_id",roleId:e}).success(function(t){r.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise}}])}(window),function(){"use strict";window.angular.module("app.RolePermissionEngine",[]).controller("RolePermissionListController",["$scope","__DataStore","__Form","$state","appServices","$rootScope","RolePermissionDataService",function(e,o,t,a,r,s,i){var n=this;n.rolePermissionDataTable=o.dataTable("#lwrolePermissionList",{url:"manage.user.role_permission.read.list",dtOptions:{searching:!0,pageLength:25},columnsData:[{name:"title",orderable:!0},{name:null,template:"#rolePermissionActionColumnTemplate"}],scope:e}),n.reloadDT=function(){o.reloadDT(n.rolePermissionDataTable)},n.delete=function(e,t){var a=$("#lwRolePermissionDeleteTextMsg");__globals.showConfirmation({html:__globals.getReplacedString(a,"__name__",_.unescape(t)),confirmButtonText:a.attr("data-delete-button-text")},function(){o.post({apiURL:"manage.user.role_permission.write.delete",rolePermissionIdOrUid:e}).success(function(e){var t=e.data.message;r.processResponse(e,{error:function(e){__globals.showConfirmation({title:a.attr("data-error-text"),text:t,type:"error"})}},function(e){__globals.showConfirmation({title:a.attr("data-success-text"),text:t,type:"success"}),n.reloadDT()})})})},n.showAddNewDialog=function(){r.showDialog({},{templateUrl:__globals.getTemplateURL("user.role-permission.add-dialog"),controller:"AddRoleController as addRoleCtrl",resolve:{addSupportData:function(){return i.getAddSupportData()}}},function(e){_.has(e.value,"role_Added")&&!0===e.value.role_Added&&n.reloadDT()})},n.rolePermissionDialog=function(e,t){r.showDialog({roleId:e,title:_.unescape(t)},{templateUrl:__globals.getTemplateURL("user.role-permission.dynamic-role-permissions"),controller:"DynamicRolePermissionController as DynamicRolePermissionCtrl",resolve:{permissionData:function(){return i.getPermissions(e)}}},function(e){})}}]).controller("DynamicRolePermissionController",["$scope","__DataStore","__Form","$stateParams","appServices","permissionData",function(t,e,a,o,r,s){var i=this,n=t.ngDialogData,c=n.roleId;(i=a.setup(i,"user_role_dynamic_access","accessData",{secured:!0,unsecuredFields:[]})).title=n.title,i.permissions=s.permissions,i.accessData.allow_permissions=s.allow_permissions,i.accessData.deny_permissions=s.deny_permissions,i.checkedPermission={},i.disablePermissions=function(e,a){_.map(e.children,function(t){_.includes(t.dependencies,a)&&_.delay(function(e){$('input[name="'+t.id+'"]').attr("disabled",!0)},500)})},_.map(i.accessData.allow_permissions,function(e){i.checkedPermission[e]="2"}),_.map(i.accessData.deny_permissions,function(a){i.checkedPermission[a]="3",_.map(i.permissions,function(e){var t=_.map(e.children,"id");_.includes(t,a)&&i.disablePermissions(e,a),_.has(e,"children_permission_group")&&_.map(e.children_permission_group,function(e){var t=_.map(e.children,"id");_.includes(t,a)&&i.disablePermissions(e,a)})})}),(i=a.updateModel(i,i.accessData)).checkPermission=function(a,o){_.isString(o)||(o=o.toString()),"2"==(i.checkedPermission[a]=o)?(_.includes(i.accessData.allow_permissions,a)||i.accessData.allow_permissions.push(a),_.includes(i.accessData.deny_permissions,a)&&(i.accessData.deny_permissions=_.without(i.accessData.deny_permissions,a))):("3"==o?_.includes(i.accessData.deny_permissions,a)||i.accessData.deny_permissions.push(a):_.includes(i.accessData.deny_permissions,a)&&(i.accessData.deny_permissions=_.without(i.accessData.deny_permissions,a)),_.includes(i.accessData.allow_permissions,a)&&(i.accessData.allow_permissions=_.without(i.accessData.allow_permissions,a))),_.map(i.permissions,function(e){var t=_.map(e.children,"id");_.includes(t,a)&&e.children[0].id==a&&_.map(e.children,function(t){t.id!=e.children[0].id&&_.map(t.dependencies,function(e){_.includes(t.dependencies,a)&&"3"==o?$('input[name="'+t.id+'"]').attr("disabled",!0):$('input[name="'+t.id+'"]').attr("disabled",!1)})}),_.has(e,"children_permission_group")&&_.map(e.children_permission_group,function(e){var t=_.map(e.children,"id");_.includes(t,a)&&e.children[0].id==a&&_.map(e.children,function(t){t.id!=e.children[0].id&&_.map(t.dependencies,function(e){_.includes(t.dependencies,a)&&"3"==o?$('input[name="'+t.id+'"]').attr("disabled",!0):$('input[name="'+t.id+'"]').attr("disabled",!1)})})})})},i.submit=function(){a.process({apiURL:"manage.user.role_permission.write.create",roleId:c},i).success(function(e){r.processResponse(e,null,function(){t.closeThisDialog()})})},i.valueUpdated=function(t,e,a,o){_.forEach(i.accessData.permissions,function(e){e[0].name==t&&(2==e[0].allow?_.map(e,function(e){_.isEmpty(e.dependencies)||(e.disabled=!1)}):3==e[0].allow?_.map(e,function(e){_.isEmpty(e.dependencies)||(e.disabled=!0,e.allow=3)}):1==e[0].allow&&(e[0].currentStatus?_.map(e,function(e){_.isEmpty(e.dependencies)||(e.disabled=!1,e.allow=1)}):_.map(e,function(e){_.isEmpty(e.dependencies)||(e.disabled=!0,e.allow=1)})))})},i.closeDialog=function(){t.closeThisDialog()}}]).controller("AddRoleController",["$scope","__DataStore","__Form","$stateParams","addSupportData","appServices","RolePermissionDataService",function(t,e,a,o,r,s,i){var n=this;(n=a.setup(n,"add_role","roleData",{secured:!1,unsecuredFields:[]})).userRoles=r.userRoles,n.permissions=r.permissionData,n.roleData.allow_permissions=[],n.roleData.deny_permissions=[],n.checkedPermission={},n.disablePermissions=function(e,a){_.map(e.children,function(t){_.includes(t.dependencies,a)&&_.delay(function(e){$('input[name="'+t.id+'"]').attr("disabled",!0)},500)})},n.getPermissions=function(e){i.getAllPermissionsById(e).then(function(e){n.permissions=e.permissionData,n.roleData.selected_permissions=e.allowedData,n.roleData.allow_permissions=e.allow_permissions,n.roleData.deny_permissions=e.deny_permissions,n.checkedPermission={},_.map(n.roleData.allow_permissions,function(e){n.checkedPermission[e]="2"}),_.map(n.roleData.deny_permissions,function(a){n.checkedPermission[a]="3",_.map(n.permissions,function(e){var t=_.map(e.children,"id");_.includes(t,a)&&n.disablePermissions(e,a),_.has(e,"children_permission_group")&&_.map(e.children_permission_group,function(e){var t=_.map(e.children,"id");_.includes(t,a)&&n.disablePermissions(e,a)})})})})},n.checkPermission=function(a,o){_.isString(o)||(o=o.toString()),"2"==(n.checkedPermission[a]=o)?(_.includes(n.roleData.allow_permissions,a)||n.roleData.allow_permissions.push(a),_.includes(n.roleData.deny_permissions,a)&&(n.roleData.deny_permissions=_.without(n.roleData.deny_permissions,a))):"3"==o&&(_.includes(n.roleData.deny_permissions,a)||n.roleData.deny_permissions.push(a),_.includes(n.roleData.allow_permissions,a)&&(n.roleData.allow_permissions=_.without(n.roleData.allow_permissions,a))),_.map(n.permissions,function(e){var t=_.map(e.children,"id");_.includes(t,a)&&e.children[0].id==a&&_.map(e.children,function(t){t.id!=e.children[0].id&&_.map(t.dependencies,function(e){_.includes(t.dependencies,a)&&"3"==o?$('input[name="'+t.id+'"]').attr("disabled",!0):$('input[name="'+t.id+'"]').attr("disabled",!1)})}),_.has(e,"children_permission_group")&&_.map(e.children_permission_group,function(e){var t=_.map(e.children,"id");_.includes(t,a)&&e.children[0].id==a&&_.map(e.children,function(t){t.id!=e.children[0].id&&_.map(t.dependencies,function(e){_.includes(t.dependencies,a)&&"3"==o?$('input[name="'+t.id+'"]').attr("disabled",!0):$('input[name="'+t.id+'"]').attr("disabled",!1)})})})})},n.submit=function(){a.process("manage.user.role_permission.write.role.create",n).success(function(e){s.processResponse(e,null,function(){t.closeThisDialog({role_Added:!0})})})},n.closeDialog=function(){t.closeThisDialog()}}])}(window),function(){"use strict";window.angular.module("app.ActivityDataServices",[]).service("ActivityDataServices",["$q","__DataStore","appServices",function(e,t,a){}])}(window),function(){"use strict";window.angular.module("app.ActivityEngine",[]).controller("ActivityLogListController",["$scope","__DataStore","__Form","$stateParams","appServices","ActivityDataServices",function(e,t,a,o,r,s){var i=[{name:"created_at",orderable:!0},{name:"created_by_user",orderable:!0},{name:"entity_type",orderable:!0},{name:"ip",orderable:!1},{name:"activity"},{name:"description"}],n=this;(n=a.setup(n,"activity_form_filters","activityLogsData",{secured:!1,unsecuredFields:[]})).getDate=function(e,t,a){n.startDate=t,n.endDate=a,n.duration=e},n.changeDate=function(e,t){n.startDate>n.endDate&&(n.endDate=n.startDate)};var c,l,d=moment().startOf("month").format("YYYY-MM-D"),u=moment().endOf("month").format("YYYY-MM-D"),p=moment().subtract(1,"months").startOf("month").format("YYYY-MM-D"),g=moment().subtract(1,"months").endOf("month").format("YYYY-MM-D"),_=moment().startOf("week").format("YYYY-MM-D"),m=moment().endOf("week").format("YYYY-MM-D"),f=moment().subtract(1,"week").startOf("week").format("YYYY-MM-D"),D=moment().subtract(1,"week").endOf("week").format("YYYY-MM-D"),h=moment().startOf("day").format("YYYY-MM-D"),v=moment().endOf("day").format("YYYY-MM-D"),b=moment().subtract(1,"day").format("YYYY-MM-D"),w=moment().subtract(1,"day").format("YYYY-MM-D"),y=moment().subtract(1,"years").startOf("years").format("YYYY-MM-D"),U=moment().subtract(1,"years").endOf("years").format("YYYY-MM-D"),S=moment().startOf("years").format("YYYY-MM-D"),C=moment().endOf("years").format("YYYY-MM-D"),j=moment().subtract(30,"days").format("YYYY-MM-D"),L=moment().format("YYYY-MM-D");n.activityDataTable=function(e,t,a){switch(parseInt(e)){case 1:c=d,l=u,n.getDate(e,c,l);break;case 2:c=p,l=g,n.getDate(e,c,l);break;case 3:c=_,l=m,n.getDate(e,c,l);break;case 4:c=f,l=D,n.getDate(e,c,l);break;case 5:c=h,l=v,n.getDate(e,c,l);break;case 6:c=b,l=w,n.getDate(e,c,l);break;case 7:c=y,l=U,n.getDate(e,c,l);break;case 8:c=S,l=C,n.getDate(e,c,l);break;case 9:c=j,l=L,n.getDate(e,c,l);break;case 10:}},n.dateChange=function(){n.activityLogDataTable&&n.activityLogDataTable.destroy(),n.activityLogDataTable=t.dataTable("#lwActivityLogList",{url:{apiURL:"manage.activity_log.read.list",startDate:n.startDate,endDate:n.endDate},dtOptions:{searching:!0,order:[[0,"desc"]],pageLength:25},columnsData:i,scope:e},null,function(e){n.durations=e._options.durations})},n.reloadDT=function(){t.reloadDT(n.activityLogDataTable)},e.$on("activity_added_or_updated",function(e){e&&n.dateChange("Today",moment().format("YYYY-MM-D"),moment().format("YYYY-MM-D"))}),n.activityDataTable("1",moment().format("YYYY-MM-D"),moment().format("YYYY-MM-D")),n.dateChange()}])}(window),function(){"use strict";window.angular.module("app.ProjectDataServices",[]).service("ProjectDataService",["$q","__DataStore","appServices",function(t,o,r){this.getAddSupportData=function(){var a=t.defer();return o.fetch("manage.project.read.support_data").success(function(t){r.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise},this.getEditSupportData=function(e){var a=t.defer();return o.fetch({apiURL:"manage.project.read.update.data",projectIdOrUid:e},{fresh:!0}).success(function(t){r.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise},this.getProjectDetails=function(e){var a=t.defer();return o.fetch({apiURL:"manage.project.read.details.data",projectIdOrUid:e}).success(function(t){r.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise}}])}(window),function(){"use strict";window.angular.module("app.ProjectEngine",[]).controller("ProjectListController",["$scope","__DataStore","__Form","$state","appServices","$rootScope","ProjectDataService",function(e,o,t,a,r,s,i){var n=this;n.projectDataTable=o.dataTable("#lwprojectList",{url:"manage.project.read.list",dtOptions:{searching:!0},columnsData:[{name:"name",orderable:!0,template:"#projectDetailsTemplate"},{name:"created_at",orderable:!0,template:"#projectCreatedAtTemplate"},{name:"updated_at",orderable:!0},{name:"formatted_status"},{name:"formatted_type"},{name:null,template:"#projectActionColumnTemplate"}],scope:e}),n.reloadDT=function(){o.reloadDT(n.projectDataTable)},e.$on("project_added_or_updated",function(e){e&&n.reloadDT()}),n.addProject=function(){r.showDialog({},{templateUrl:"project.add-dialog",controller:"ProjectAddController as projectAddCtrl",resolve:{projectAddData:["ProjectDataService",function(e){return e.getAddSupportData()}]}},function(e){_.has(e.value,"project_added_or_updated")&&e.value.project_added_or_updated&&s.$broadcast("project_added_or_updated",!0)})},n.editProject=function(t){r.showDialog({projectIdOrUid:t},{templateUrl:"project.edit-dialog",controller:"ProjectEditController as projectEditCtrl",resolve:{projectEditData:["ProjectDataService",function(e){return e.getEditSupportData(t)}]}},function(e){_.has(e.value,"project_added_or_updated")&&e.value.project_added_or_updated&&s.$broadcast("project_added_or_updated",!0)})},n.showProjectDetails=function(t){r.showDialog({projectIdOrUid:t},{templateUrl:"project.details-dialog",controller:"ProjectDetailsController as projectDetailsCtrl",resolve:{ProjectDetailsData:["ProjectDataService",function(e){return e.getProjectDetails(t)}]}},function(e){})},n.showEmbedScriptDialog=function(e){r.showDialog({projectSlug:e,embededType:1},{templateUrl:"embed.embed-script-dialog",controller:"EmbedScriptDialogController as EmbedScriptDialogCtrl"},function(e){})},n.delete=function(e,t){n.projectName=t,_.defer(function(){var a=$("#lwProjectDeleteConfirmTextMsg");__globals.showConfirmation({html:a.attr("data-message"),confirmButtonText:a.attr("data-delete-button-text")},function(){o.post({apiURL:"manage.project.write.delete",projectIdOrUid:e}).success(function(e){var t=e.data.message;r.processResponse(e,{error:function(){__globals.showConfirmation({title:"Deleted!",text:t,type:"error"})}},function(){__globals.showConfirmation({title:"Deleted!",text:a.attr("success-msg"),type:"success"}),n.reloadDT()})})})})}}]).controller("ProjectAddController",["$scope","__DataStore","__Form","$state","appServices","$rootScope","projectAddData","lwFileUploader","__Utils",function(a,e,t,o,r,s,i,n,c){var l=this;l.project_type=i.project_type,l.recent_languages=i.recent_languages,l.showLoader=!0,(l=t.setup(l,"project_form","projectData",{secured:!1,unsecuredFields:[]})).projectData.status=1,l.projectData.type=1,l.languages=i.languages,l.languageSelectize=__globals.getSelectizeOptions({valueField:"id",labelField:"name",searchField:["name"],maxItems:null,plugins:["remove_button"],onChange:function(e){l.updatePrimaryLangOptions(e)}}),l.primaryLanguageSelectize=__globals.getSelectizeOptions({valueField:"id",labelField:"name",searchField:["name"]}),l.projectData.article_comments_status=1,l.projectData.article_votes_status=1,l.primarylanguages=[],l.addNewLanguage=function(){r.showDialog(l,{templateUrl:__globals.getTemplateURL("language.add-dialog"),controller:"LanguageAddController as languageAddCtrl"},function(e){_.has(e.value,"language_added_or_updated")&&e.value.language_added_or_updated&&l.languages.push(e.value.add_language_data)})},l.updatePrimaryLangOptions=function(t){l.primarylanguages=[],l.projectData.primary_language="",_.map(l.languages,function(e){_.includes(t.split(","),e.id)&&l.primarylanguages.push(e)})},l.projectData.project_languages=[],l.selectRecentLanguage=function(e){_.isUndefined(l.projectData.project_languages)&&(l.projectData.project_languages=[]),_.includes(l.projectData.project_languages,e)||l.projectData.project_languages.push(e)},l.openVersionAddDialog=function(t){r.showDialog({projectUid:t},{templateUrl:__globals.getTemplateURL("version.add-dialog"),controller:"VersionAddController as versionAddCtrl",resolve:{versionAddData:["VersionDataService",function(e){return e.getAddSupportData(t)}]}},function(e){_.has(e.value,"version_added")&&e.value.version_added&&s.$broadcast("load_versions_list")})},l.submit=function(){t.process("manage.project.write.create",l).success(function(e){r.processResponse(e,null,function(){e.reaction&&(a.closeThisDialog({project_added_or_updated:!0}),s.canAccess("manage.project.version.read.list")&&o.go("project_versions",{projectIdOrUid:e.data.projectIdOrUid}))})})},a.upload=function(){n.upload({url:c.apiURL("media.upload.write.project")},function(e){e=e.result.data.fileDetails;_.isUndefined(e)||("ico"===e.extension?(l.projectData.favicon_image=e.file_name,l.favicon_image_url=e.url):(l.projectData.logo_image=e.file_name,l.logo_image_url=e.url))})},$(document).bind("dragover",function(e){a.upload()}),s.$on("lw-loader-event-start",function(e,t){a.loading=!0,$("#lwFileupload").attr("disabled",!0)}),s.$on("lw-loader-event-stop",function(e,t){a.loading=!1,$("#lwFileupload").attr("disabled",!1)}),l.generateSlug=function(e){l.projectData.slug=__globals.slug(e)},l.closeDialog=function(){a.closeThisDialog()}}]).controller("ProjectEditController",["$scope","__DataStore","__Form","$state","appServices","$rootScope","projectEditData","lwFileUploader","__Utils",function(a,i,e,t,n,o,r,s,c){(l=this).showLoader=!0,l.projectIdOrUid=a.ngDialogData.projectIdOrUid;var l=e.setup(l,"project_form","projectData",{secured:!1,unsecuredFields:[]}),d=r;(l=e.updateModel(l,d.edit_data)).logoImageExists=d.logoImageExists,l.faviconImageExist=d.faviconImageExist,l.showLoader=!1,l.languages=r.languages,l.projectLanguages=r.projectLanguages,l.languageSelectize=__globals.getSelectizeOptions({valueField:"lang_id",labelField:"name",searchField:["name"],plugins:["remove_button"],maxItems:null,delimiter:",",persist:!1,onDelete:function(e){return l.deleteLanguage(e[0],this).then(function(e){return!0}).catch(function(e){return!1}),!1}}),l.primaryLanguageSelectize=__globals.getSelectizeOptions({valueField:"lang_id",labelField:"name",searchField:["name"]}),l.primarylanguages=[],l.deleteLanguage=function(r,s){return new Promise(function(a,o){var e=$("#lwLanguageDeleteConfirm");_.includes(l.projectLanguages,r)?__globals.showConfirmation({html:e.attr("data-message"),confirmButtonText:e.attr("data-delete-button-text")},function(){i.post({apiURL:"manage.project.write.language_delete",projectIdOrUid:l.projectIdOrUid,languageId:r}).success(function(e){var t=e.data.message;n.processResponse(e,{error:function(){__globals.showConfirmation({title:"Deleted!",text:t,type:"error"}),o("error")}},function(){__globals.showConfirmation({title:"Deleted!",text:l.successMsgText,type:"success"}),s.removeOption(r),s.refreshOptions(),s.clearCache(),a("success")})})}):(s.removeOption(r),s.refreshOptions(),s.clearCache())})},l.deleteMedia=function(t){i.post({apiURL:"manage.project.write.media_delete",projectIdOrUid:l.projectIdOrUid,mediaType:t},{}).success(function(e){n.processResponse(e,null,function(e){1==e&&(1==t?l.logo_image_url="":2==t&&(l.favicon_image_url=""))})})},l.submit=function(){e.process({apiURL:"manage.project.write.update",projectIdOrUid:l.projectIdOrUid},l).success(function(e){n.processResponse(e,null,function(){a.closeThisDialog({project_added_or_updated:!0})})})},l.logo_image_url=l.projectData.logo_image_url,l.favicon_image_url=l.projectData.favicon_image_url,a.upload=function(){s.upload({url:c.apiURL("media.upload.write.project")},function(e){e=e.result.data.fileDetails;_.isUndefined(e)||("ico"===e.extension?(l.projectData.favicon_image=e.file_name,l.favicon_image_url=e.url):(l.projectData.logo_image=e.file_name,l.logo_image_url=e.url))})},$(document).bind("dragover",function(e){a.upload()}),o.$on("lw-loader-event-start",function(e,t){a.loading=!0,$("#lwFileupload").attr("disabled",!0)}),o.$on("lw-loader-event-stop",function(e,t){a.loading=!1,$("#lwFileupload").attr("disabled",!1)}),l.generateSlug=function(e){l.projectData.slug=__globals.slug(e)},l.closeDialog=function(){a.closeThisDialog()}}]).controller("ProjectDetailsController",["$scope","appServices","ProjectDetailsData",function(e,t,a){this.projectData=a.projectData,this.closeDialog=function(){e.closeThisDialog()}}])}(window),function(){"use strict";window.angular.module("app.ArticleDataServices",[]).service("ArticleDataService",["$q","__DataStore","appServices",function(r,s,i){this.getAddSupportData=function(e,t){var a=r.defer();return s.fetch({apiURL:"manage.article.read.support_data",projectUid:e||null,versionUid:t||null}).success(function(t){i.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise},this.getEditSupportData=function(e,t,a){var o=r.defer();return s.fetch({apiURL:"manage.article.read.update.data",articleIdOrUid:e,projectUid:t||null,versionUid:a||null}).success(function(t){i.processResponse(t,null,function(e){o.resolve(t.data)})}),o.promise},this.getVotesSupportData=function(e){var a=r.defer();return s.fetch({apiURL:"manage.article.votes.read",articleIdOrUid:e}).success(function(t){i.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise},this.getArticleContentDetails=function(e,t){var a=r.defer();return s.fetch({apiURL:"manage.article.read.content_details",articleIdOrUid:t,contentUid:e}).success(function(t){i.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise},this.getArticleDetails=function(e){var a=r.defer();return s.fetch({apiURL:"manage.article.read.details",articleIdOrUid:e}).success(function(t){i.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise},this.getArticles=function(e,t){var a=r.defer();return s.fetch({apiURL:"manage.article.read.list","projectUid?":e,"versionUid?":t}).success(function(t){i.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise}}])}(window),function(){"use strict";window.angular.module("app.ArticleEngine",[]).controller("ArticleListController",["$scope","__DataStore","__Form","$state","appServices","$rootScope","appNotify","GetVersionDetails","GetArticles",function(e,s,t,a,i,o,r,n,c){var l=this;l.projectUid=a.params.projectUid,l.versionUid=a.params.versionUid,l.version_info=n.versionData,l.project_info=n.project_info,l.articles=c.articles,l.projectSlug=c.projectSlug,l.versionSlug=c.versionSlug,l.languages__id=c.languages__id,l.getArticles=function(){s.fetch({apiURL:"manage.article.read.list","projectUid?":l.projectUid,"versionUid?":l.versionUid}).success(function(t){i.processResponse(t,null,function(e){l.articles=t.data.articles,l.projectSlug=t.data.projectSlug,l.versionSlug=t.data.versionSlug,l.languages__id=t.data.languages__id})})},e.$on("article_added_or_updated",function(e){e&&l.reloadDT()}),l.addArticle=function(){i.showDialog({},{templateUrl:"article.add-dialog",controller:"ArticleAddController as articleAddCtrl",resolve:{articleAddData:["ArticleDataService",function(e){return e.getAddSupportData()}]}},function(e){_.has(e.value,"article_added_or_updated")&&e.value.article_added_or_updated&&o.$broadcast("article_added_or_updated",!0)})},l.showArticleContentDetails=function(t,a){i.showDialog({articleIdOrUid:a,contentUid:t},{templateUrl:"article.article-content-details-dialog",controller:"ArticleContentDetailsController as ArticleContentDetailsCtrl",resolve:{ArticleContentData:["ArticleDataService",function(e){return e.getArticleContentDetails(t,a)}]}},function(e){})},l.delete=function(e,t){l.articleName=t,_.defer(function(){var a=$("#lwArticleDeleteConfirmTextMsg");__globals.showConfirmation({html:a.attr("data-message"),confirmButtonText:a.attr("data-delete-button-text")},function(){s.post({apiURL:"manage.article.write.delete",articleIdOrUid:e}).success(function(e){var t=e.data.message;i.processResponse(e,{error:function(){__globals.showConfirmation({title:"Deleted!",text:t,type:"error"})}},function(){__globals.showConfirmation({title:"Deleted!",text:a.attr("success-msg"),type:"success"}),l.getArticles()})})})})},l.showArticleEmbedScriptDialog=function(e,t,a,o){i.showDialog({projectSlug:e,versionSlug:t,articleSlug:a,language:o,embededType:3},{templateUrl:"embed.embed-script-dialog",controller:"EmbedScriptDialogController as EmbedScriptDialogCtrl"},function(e){})},e.toggle=function(e){e.toggle()},e.treeOptions={accept:function(e,t,a){return!0},beforeDrop:function(e){var t=e.source.nodeScope.$modelValue,a=e.dest.nodesScope.node||void 0,o=_.isUndefined(a)?"":a._id,r=e.dest.nodesScope.$modelValue;_.delay(function(){var a;t&&0<r.length&&(a=[],_.forEach(_.compact(r),function(e,t){a.push({_id:e._id,list_order:t+1,previous_articles__id:o})}),s.post({apiURL:"manage.article.write.update_parent",articleIdOrUid:t._uid},{parentId:o,listOrderData:a}).success(function(e){i.processResponse(e,null,function(e){l.getArticles()})}))},50)}}}]).controller("EmbedScriptDialogController",["$scope","__DataStore","__Form","$state","appServices","$rootScope",function(e,t,a,o,r,s){var i=this,n=e.ngDialogData,c=n.embededType;i.articleTitle=n.title,i.convertToString=function(e){var t=[];return _.forEach(e,function(e){t.push(JSON.stringify(e))}),t},1==c?i.scriptContent=i.convertToString([n.projectSlug]):2==c?i.scriptContent=i.convertToString([n.projectSlug,n.versionSlug]):3==c&&(i.scriptContent=i.convertToString([n.projectSlug,n.versionSlug,n.articleSlug])),i.loadArticleScript=function(){return"\n<script type='text/javascript'>Docsyard.load("+i.scriptContent+");<\/script>"},i.closeDialog=function(){e.closeThisDialog()}}]).controller("ArticleAddController",["$scope","__DataStore","__Form","$state","appServices","$rootScope","articleAddData","appNotify",function(e,t,a,o,r,s,i,n){var c=this;c.showLoader=!0,c.primaryArticleExist=!0,c.isPrimaryLanguageSelected=!0,(c=a.setup(c,"article_form","articleData",{secured:!1,unsecuredFields:[]})).projectSelectize=__globals.getSelectizeOptions({valueField:"id",labelField:"name",searchField:["name"]}),c.prevArticle=__globals.getSelectizeOptions({valueField:"_id",labelField:"title",searchField:["title"],render:{option:function(e,t){var a=e.count;return'<div><span class="title">'+(1<e.count?"&nbsp".repeat(a)+"&#8627 ":"")+t(e.title)+"</span></div>"}}}),c.articleData.articles_content=i.articles_content,c.version_info=i.versionData,c.project_info=i.projectName,c.articleData.projectUid=o.params.projectUid,c.articleData.article_type=1,c.articleData.doc_versions__id=c.version_info._id,c.projectUid=o.params.projectUid,c.articlesList=i.articles,c.requestType=o.params.requestType,c.projectName=i.projectName,c.primaryLanguage=i.primaryLanguage,_.has(o.params,"prevArticle")&&(c.articleData.previous_articles__id=o.params.prevArticle),c.selectTabId=c.primaryLanguage,c.selectedTab=function(e,t,a){e.preventDefault(),c.selectTabId=a,c.isPrimaryLanguageSelected=t==a,c.checkPrimaryArticleExist()},c.checkPrimaryArticleExist=function(){var t=!1;c.isPrimaryLanguageSelected||_.forEach(c.articleData.articles_content,function(e){1==e.is_primary&&(_.isEmpty(e.description)||_.isEmpty(e.title))&&(t=!0)}),c.primaryArticleExist=!t},c.submit=function(t){if(c.checkPrimaryArticleExist(),!c.primaryArticleExist)return n.error("You have to add primary language article first.");c.articleData.status=t,a.process({apiURL:"manage.article.write.create",requestType:c.requestType,projectUid:c.projectUid||null},c).success(function(e){r.processResponse(e,null,function(){1==t?o.go("project_articles",{projectUid:c.projectUid,versionUid:c.version_info._uid}):2!=t&&3!=t||o.go("project_article_edit",{projectUid:c.projectUid,versionUid:c.version_info._uid,articleIdOrUid:e.data.article_uid})})})},c.closeDialog=function(){e.closeThisDialog()}}]).controller("ArticleEditController",["$scope","__DataStore","__Form","$state","appServices","$rootScope","articleEditData",function(e,t,a,o,r,s,i){var n=this;n.showLoader=!0;var c=i;(n=a.setup(n,"article_form","articleData",{secured:!1,unsecuredFields:[]})).articlesList=c.articles,n.projectName=c.projectName,n.requestType=2,_.isNull(c.articleData.previous_articles__id)&&(n.requestType=1),n.version_info=i.versionData,n.project_info=i.projectName,(n=a.updateModel(n,c.articleData)).showLoader=!1;var l=o.params.articleIdOrUid;n.projectUid=o.params.projectUid,_.isUndefined(o.params.projectUid)?n.projectUid="null":n.projectUid=o.params.projectUid,n.article_status=c.articleData.article_status,n.prevArticle=__globals.getSelectizeOptions({valueField:"_id",labelField:"title",searchField:["title"],render:{option:function(e,t){var a=e.count;return'<div><span class="title">'+(1<e.count?"&nbsp".repeat(a)+"&#8627 ":"")+t(e.title)+"</span></div>"}}}),n.primaryLanguage=i.primaryLanguage,n.selectTabId=n.primaryLanguage,n.selectedTab=function(e,t){e.preventDefault(),n.selectTabId=t},n.submit=function(t){n.articleData.status=t,a.process({apiURL:"manage.article.write.update",articleIdOrUid:l,projectUid:n.projectUid,requestType:n.requestType},n).success(function(e){r.processResponse(e,null,function(){3==t&&o.go("project_articles",{projectUid:n.projectUid,versionUid:n.version_info._uid})})})},n.closeDialog=function(){e.closeThisDialog()}}]).controller("ArticleContentDetailsController",["$scope","ArticleContentData",function(e,t){this.article_content=t.article_content,this.closeDialog=function(){e.closeThisDialog()}}])}(window),function(){"use strict";window.angular.module("app.LanguageDataServices",[]).service("LanguageDataService",["$q","__DataStore","appServices",function(t,o,r){this.getAddSupportData=function(){var a=t.defer();return o.fetch("manage.language.read.support_data").success(function(t){r.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise},this.getEditSupportData=function(e){var a=t.defer();return o.fetch({apiURL:"manage.language.read.update.data",languageIdOrUid:e}).success(function(t){r.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise}}])}(window),function(){"use strict";window.angular.module("app.LanguageEngine",[]).controller("LanguageController",["$scope","__DataStore","__Form","$stateParams",function(e,t,a,o){}]).controller("LanguageListController",["$scope","__DataStore","__Form","$state","appServices","$rootScope","LanguageDataService",function(e,o,t,a,r,s,i){var n=this;n.languageDataTable=o.dataTable("#lwLanguageList",{url:"manage.language.read.list",dtOptions:{searching:!0},columnsData:[{name:"name",orderable:!0},{name:"_id",orderable:!0},{name:"is_rtl",orderable:!0},{name:null,template:"#languageActionColumnTemplate"}],scope:e}),n.reloadDT=function(){o.reloadDT(n.languageDataTable)},e.$on("language_added_or_updated",function(e){e&&n.reloadDT()}),n.delete=function(e,t){n.languagename=t,_.defer(function(){var a=$("#lwLanguageDelete");__globals.showConfirmation({html:a.attr("data-message"),confirmButtonText:a.attr("data-delete-button-text")},function(){o.post({apiURL:"manage.language.write.delete",languageIdOrUid:e}).success(function(e){var t=e.data.message;r.processResponse(e,{error:function(){__globals.showConfirmation({title:"Deleted!",text:t,type:"error"})}},function(){__globals.showConfirmation({title:"Deleted!",text:a.attr("success-msg"),type:"success"}),n.reloadDT()})})})})},n.openAddDialog=function(){r.showDialog(n,{templateUrl:__globals.getTemplateURL("language.add-dialog"),controller:"LanguageAddController as languageAddCtrl"},function(e){_.has(e.value,"language_added_or_updated")&&e.value.language_added_or_updated&&n.reloadDT()})},n.openEditDialog=function(e){r.showDialog({languageIdOrUid:e},{templateUrl:__globals.getTemplateURL("language.edit-dialog"),controller:"LanguageEditController as languageEditCtrl",resolve:{languageEditData:function(){return i.getEditSupportData(e)}}},function(e){_.has(e.value,"language_added_or_updated")&&e.value.language_added_or_updated&&n.reloadDT()})}}]).controller("LanguageAddController",["$scope","__DataStore","__Form","$state","appServices","$rootScope",function(t,e,a,o,r,s){var i=this;i.showLoader=!0,(i=a.setup(i,"language_form","languageData",{secured:!0,unsecuredFields:["name","code"]})).languageData.status=1,i.languageData.is_rtl=2,i.submit=function(){a.process("manage.language.write.create",i).success(function(e){r.processResponse(e,null,function(){t.closeThisDialog({language_added_or_updated:!0,add_language_data:e.data.addLanguageData})})})},i.closeDialog=function(){t.closeThisDialog()}}]).controller("LanguageEditController",["$scope","__DataStore","__Form","$state","appServices","$rootScope","languageEditData",function(t,e,a,o,r,s,i){(n=this).showLoader=!0;var n=a.setup(n,"language_form","languageData",{secured:!0,unsecuredFields:["name"]});(n=a.updateModel(n,i.editData)).showLoader=!1;var c=t.ngDialogData.languageIdOrUid;n.submit=function(){a.process({apiURL:"manage.language.write.update",languageIdOrUid:c},n).success(function(e){r.processResponse(e,null,function(){t.closeThisDialog({language_added_or_updated:!0})})})},n.closeDialog=function(){t.closeThisDialog()}}])}(window),function(){"use strict";window.angular.module("app.VersionDataServices",[]).service("VersionDataService",["$q","__DataStore","appServices",function(o,r,s){this.getProjectInfo=function(e){var a=o.defer();return r.fetch({apiURL:"manage.project.version.read.project_info",projectIdOrUid:e}).success(function(t){s.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise},this.getVersions=function(e){var a=o.defer();return r.fetch({apiURL:"manage.project.version.read.list",projectIdOrUid:e}).success(function(t){s.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise},this.getAddSupportData=function(e){var a=o.defer();return r.fetch({apiURL:"manage.project.version.read.support_data",projectIdOrUid:e}).success(function(t){s.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise},this.getEditSupportData=function(e,t){var a=o.defer();return r.fetch({apiURL:"manage.project.version.read.update.data",projectIdOrUid:e,versionUid:t}).success(function(t){s.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise},this.getVersionSupportData=function(e,t){var a=o.defer();return r.fetch({apiURL:"manage.project.version.read.get_support_data",projectIdOrUid:e,versionUid:t}).success(function(t){s.processResponse(t,null,function(e){a.resolve(t.data)})}),a.promise}}])}(window),function(){"use strict";window.angular.module("app.VersionEngine",[]).controller("VersionListController",["$scope","__DataStore","__Form","$state","appServices","$rootScope","ProjectInfo","GetVersions",function(e,a,t,o,r,s,i,n){var c=this;c.projectInfo=i.info,c.versions=n.versionList,c.projectUid=c.projectInfo._uid,c.projectIdOrUid=o.params.projectIdOrUid,c.getVersions=function(){a.fetch({apiURL:"manage.project.version.read.list",projectIdOrUid:o.params.projectIdOrUid}).success(function(e){r.processResponse(e,null,function(){c.versions=e.data.versionList})})},c.delete=function(t,e){c.deletingTagName=_.unescape(e),_.defer(function(){var e=$("#lwVersionDeleteConfirm");c.deleteText=e.attr("data-message"),c.deleteConfirmBtnText=e.attr("data-delete-button-text"),c.successMsgText=e.attr("success-msg"),__globals.showConfirmation({html:c.deleteText,confirmButtonText:c.deleteConfirmBtnText},function(){a.post({apiURL:"manage.project.version.write.delete",projectIdOrUid:c.projectUid,versionUid:t}).success(function(e){var t=e.data.message;r.processResponse(e,{error:function(){__globals.showConfirmation({title:"Deleted!",text:t,type:"error"})}},function(){__globals.showConfirmation({title:"Deleted!",text:c.successMsgText,type:"success"}),c.getVersions()})})})})},c.openAddDialog=function(t){r.showDialog({projectUid:t},{templateUrl:__globals.getTemplateURL("version.add-dialog"),controller:"VersionAddController as versionAddCtrl",resolve:{versionAddData:["VersionDataService",function(e){return e.getAddSupportData(t)}]}},function(e){_.has(e.value,"version_added")&&e.value.version_added&&c.getVersions()})},e.$on("load_versions_list",function(e,t){c.getVersions()}),c.openEditDialog=function(t){r.showDialog({projectIdOrUid:c.projectUid,projectId:c.projectInfo._id},{templateUrl:__globals.getTemplateURL("version.edit-dialog"),controller:"VersionEditController as versionEditCtrl",resolve:{versionEditData:["VersionDataService",function(e){return e.getEditSupportData(c.projectUid,t)}]}},function(e){_.has(e.value,"version_added")&&e.value.version_added&&c.getVersions()})},c.showEmbedScriptDialog=function(e,t,a){r.showDialog({projectSlug:e,versionSlug:t,embededType:2},{templateUrl:"embed.embed-script-dialog",controller:"EmbedScriptDialogController as EmbedScriptDialogCtrl"},function(e){})}}]).controller("VersionAddController",["$scope","__DataStore","__Form","$state","appServices","$rootScope","versionAddData",function(t,e,a,o,r,s,i){var n=this;n.projectUid=t.ngDialogData.projectUid,n.existingVersions=i.existing_versions,n.existing_versions_count=i.existing_versions_count,n.showLoader=!0,(n=a.setup(n,"version_form","versionData",{secured:!1,unsecuredFields:["version"]})).versionData.status=1,n.versionData.projects__id=i.projectId,0==parseInt(n.existing_versions_count)&&(n.versionData.is_primary=1),n.submit=function(){a.process({apiURL:"manage.project.version.write.create",projectIdOrUid:n.projectUid},n).success(function(e){r.processResponse(e,null,function(){t.closeThisDialog({version_added:!0})})})},n.changeStatus=function(e){"1"==e&&(n.versionData.status=1)},n.closeDialog=function(){t.closeThisDialog()}}]).controller("VersionEditController",["$scope","__DataStore","__Form","$state","appServices","$rootScope","versionEditData",function(t,e,a,o,r,s,i){(n=this).showLoader=!0,n.projectId=t.ngDialogData.projectId;var n=a.setup(n,"version_form","versionData",{secured:!1,unsecuredFields:[]}),c=i.versionData;(n=a.updateModel(n,c)).showLoader=!1,n.submit=function(){a.process({apiURL:"manage.project.version.write.update",projectIdOrUid:n.projectId,versionUid:c._uid},n).success(function(e){r.processResponse(e,null,function(){t.closeThisDialog({version_added:!0})})})},n.changeStatus=function(e){"1"==e&&(n.versionData.status=1)},n.closeDialog=function(){t.closeThisDialog()}}])}(window);